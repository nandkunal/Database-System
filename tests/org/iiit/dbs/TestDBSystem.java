package org.iiit.dbs;



import org.junit.After;
import org.junit.Before;
import org.junit.Test;

public class TestDBSystem {
	private DBSystem dbSystem = null;
	
	
	@Before
	public void setUp(){
		dbSystem = new DBSystem();
		String configPath = "resources/config.txt";
		DBConfigReader.getInstance().readConfig(configPath);
	}
	
	//@Test
	public void testpopulateDBInfo(){
		dbSystem.populateDBInfo();
		dbSystem.displayDataBaseMetaData();
	}
	
	//@Test
	public void testinsertRecord()
	{  
		dbSystem.populateDBInfo();
		dbSystem.initializeLRUTable();
		dbSystem.insertRecord("testcountries","302614,IN,INDIA,AS");
		dbSystem.flushPages();
	}
	
	@Test
	public void testgetRecord(){
		dbSystem.populateDBInfo();
		dbSystem.initializeLRUTable();
		//System.out.println(dbSystem.getRecord("countries",0));
		System.out.println(dbSystem.getRecord("countries",44));
	}
	@After
	public void tearDown(){
		dbSystem = null;
	}
	

}
